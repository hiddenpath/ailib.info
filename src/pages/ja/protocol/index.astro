---
import '../../../styles/global.css';
import SiteHeader from '../../../components/SiteHeader.astro';
import Footer from '../../../components/Footer.astro';
import EcosystemOverview from '../../../components/diagrams/EcosystemOverview.astro';

const locale = 'ja';
---

<html lang="ja" class="scroll-smooth">
  <head>
    <meta charset="utf-8" />
    <title>AI-Protocol | プロバイダー非依存 AI 仕様</title>
    <meta name="description" content="AI-Protocol は AI モデルとのやり取りを標準化するプロバイダー非依存の仕様です。37 プロバイダー、YAML マニフェスト、JSON Schema で検証。" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="icon" href="/favicon.svg" />
  </head>
  <body>
    <SiteHeader locale={locale} />

    <main>
      <!-- Hero -->
      <section class="relative pt-16 pb-20 overflow-hidden">
        <div class="absolute inset-0 -z-10">
          <div class="absolute top-0 left-1/3 w-96 h-96 bg-purple-500/5 rounded-full blur-3xl"></div>
          <div class="absolute bottom-0 right-1/4 w-80 h-80 bg-pink-500/5 rounded-full blur-3xl"></div>
        </div>
        <div class="container">
          <div class="max-w-4xl">
            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium bg-purple-500/10 text-purple-400 border border-purple-500/20 mb-6">
              仕様 v0.7.0 &middot; 37 プロバイダー
            </div>
            <h1 class="text-4xl md:text-6xl font-extrabold tracking-tight mb-6 leading-[1.05]">
              <span class="text-[var(--text)]">すべてを駆動する</span>
              <span class="gradient-text-protocol">仕様</span>
              <span class="text-[var(--text)]">。</span>
            </h1>
            <p class="text-lg md:text-xl text-[var(--text-dim)] max-w-2xl mb-8 leading-relaxed">
              AI-Protocol は「何をするか」と「どうするか」を分離します。V2 仕様は 3 層アーキテクチャを使用：コアプロトコル &rarr; 機能拡張 &rarr; 環境プロファイル。プロバイダーマニフェストはエンドポイント、認証、パラメータマッピング、ストリーミングデコーダー、エラーハンドリングを宣言 — すべて YAML で、すべて JSON Schema により検証されます。
            </p>
            <div class="flex flex-wrap gap-4">
              <a href="/ja/protocol/overview/" class="inline-flex items-center gap-2 px-6 py-3 bg-purple-600 text-white font-semibold rounded-lg hover:bg-purple-700 transition-all hover:no-underline">
                ドキュメントを読む
              </a>
              <a href="https://github.com/hiddenpath/ai-protocol" target="_blank" rel="noopener" class="inline-flex items-center gap-2 px-6 py-3 border border-[var(--border)] text-[var(--text)] font-semibold rounded-lg hover:bg-[var(--bg-alt)] transition-all hover:no-underline">
                GitHub で見る
              </a>
            </div>
          </div>
        </div>
      </section>

      <!-- V2 Architecture -->
      <section class="section">
        <div class="container">
          <h2 class="text-3xl font-bold text-[var(--text)] mb-6 text-center">V2 三層アーキテクチャ</h2>
          <p class="text-lg text-[var(--text-dim)] max-w-2xl mx-auto text-center mb-8">
            V2 は仕様を 3 層に整理：<strong class="text-[var(--text)]">コアプロトコル</strong>（基本チャット、ストリーミング、エラー）&rarr; <strong class="text-[var(--text)]">機能拡張</strong>（ツール、ビジョン、構造化出力）&rarr; <strong class="text-[var(--text)]">環境プロファイル</strong>（プロバイダー固有設定）。V2-alpha マニフェストは OpenAI、Anthropic、Gemini に対応しています。
          </p>
        </div>
      </section>

      <!-- What's in the Protocol -->
      <section class="section-alt">
        <div class="container">
          <h2 class="text-3xl font-bold text-[var(--text)] mb-10 text-center">仕様の内容</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <div class="p-6 rounded-xl border border-[var(--border)] bg-[var(--bg-card)]">
              <div class="text-3xl font-extrabold gradient-text-protocol mb-2">spec.yaml</div>
              <h3 class="font-bold text-[var(--text)] mb-2">コア仕様</h3>
              <p class="text-sm text-[var(--text-dim)]">標準パラメータ（temperature、max_tokens）、ストリーミングイベント（PartialContentDelta、ToolCallStarted）、エラークラス（13 種類）、リトライポリシーを定義。</p>
            </div>
            <div class="p-6 rounded-xl border border-[var(--border)] bg-[var(--bg-card)]">
              <div class="text-3xl font-extrabold gradient-text-protocol mb-2">providers/</div>
              <h3 class="font-bold text-[var(--text)] mb-2">37 プロバイダーマニフェスト</h3>
              <p class="text-sm text-[var(--text-dim)]">各 YAML ファイルはプロバイダーのエンドポイント、認証、パラメータマッピング、SSE デコーダー設定、エラー分類、レート制限ヘッダー、機能を宣言します。</p>
            </div>
            <div class="p-6 rounded-xl border border-[var(--border)] bg-[var(--bg-card)]">
              <div class="text-3xl font-extrabold gradient-text-protocol mb-2">models/</div>
              <h3 class="font-bold text-[var(--text)] mb-2">モデルレジストリ</h3>
              <p class="text-sm text-[var(--text-dim)]">プロバイダー参照、コンテキストウィンドウ、機能フラグ、トークン単価を持つモデルインスタンス。GPT、Claude、Gemini、DeepSeek、Qwen など。</p>
            </div>
            <div class="p-6 rounded-xl border border-[var(--border)] bg-[var(--bg-card)]">
              <div class="text-3xl font-extrabold gradient-text-protocol mb-2">schemas/</div>
              <h3 class="font-bold text-[var(--text)] mb-2">JSON Schema 検証</h3>
              <p class="text-sm text-[var(--text-dim)]">JSON Schema 2020-12 定義がすべてのマニフェストを検証。CI パイプラインで設定の正確性を保証。実行時サプライズゼロ。</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Provider Manifest Example -->
      <section class="section">
        <div class="container">
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 items-start">
            <div>
              <h2 class="text-3xl font-bold text-[var(--text)] mb-4">プロバイダーマニフェスト</h2>
              <p class="text-[var(--text-dim)] mb-6 leading-relaxed">
                各プロバイダーは YAML マニフェストで記述されます。ランタイムがプロバイダーと通信するために必要なすべて — エンドポイント、認証、パラメータマッピング、ストリーミングデコーダー、エラーハンドリング、機能 — を宣言します。
              </p>
              <p class="text-[var(--text-dim)] mb-4 leading-relaxed">
                ランタイムはこれらのマニフェストを読み、ユーザーリクエストをプロバイダー固有の HTTP 呼び出しに「コンパイル」します。<code>if provider == "openai"</code> の分岐はどこにもありません。
              </p>
              <ul class="space-y-3">
                <li class="flex items-start gap-3">
                  <svg class="w-5 h-5 text-purple-400 mt-0.5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
                  <span class="text-sm text-[var(--text-dim)]"><strong class="text-[var(--text)]">エンドポイント＆認証</strong> — ベース URL、プロトコル、Bearer トークン、API キーヘッダー</span>
                </li>
                <li class="flex items-start gap-3">
                  <svg class="w-5 h-5 text-purple-400 mt-0.5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
                  <span class="text-sm text-[var(--text-dim)]"><strong class="text-[var(--text)]">パラメータマッピング</strong> — 標準名からプロバイダー固有 JSON フィールドへ</span>
                </li>
                <li class="flex items-start gap-3">
                  <svg class="w-5 h-5 text-purple-400 mt-0.5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
                  <span class="text-sm text-[var(--text-dim)]"><strong class="text-[var(--text)]">ストリーミングデコーダー</strong> — SSE/NDJSON フォーマット、JSONPath イベント抽出ルール</span>
                </li>
                <li class="flex items-start gap-3">
                  <svg class="w-5 h-5 text-purple-400 mt-0.5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
                  <span class="text-sm text-[var(--text-dim)]"><strong class="text-[var(--text)]">エラー分類</strong> — HTTP ステータスコードから 13 種類の標準エラー型へ</span>
                </li>
              </ul>
            </div>
            <div>
              <pre class="text-sm !bg-[#0d1117] !border-purple-500/20"><code class="language-yaml"><span style="color:#7ee787">id</span>: anthropic
<span style="color:#7ee787">protocol_version</span>: <span style="color:#a5d6ff">"0.7.0"</span>
<span style="color:#7ee787">endpoint</span>:
  <span style="color:#7ee787">base_url</span>: <span style="color:#a5d6ff">"https://api.anthropic.com/v1"</span>
  <span style="color:#7ee787">chat_path</span>: <span style="color:#a5d6ff">"/messages"</span>
<span style="color:#7ee787">auth</span>:
  <span style="color:#7ee787">type</span>: bearer
  <span style="color:#7ee787">token_env</span>: <span style="color:#a5d6ff">"ANTHROPIC_API_KEY"</span>
<span style="color:#7ee787">parameter_mappings</span>:
  <span style="color:#7ee787">temperature</span>: <span style="color:#a5d6ff">"temperature"</span>
  <span style="color:#7ee787">max_tokens</span>: <span style="color:#a5d6ff">"max_tokens"</span>
  <span style="color:#7ee787">stream</span>: <span style="color:#a5d6ff">"stream"</span>
<span style="color:#7ee787">streaming</span>:
  <span style="color:#7ee787">decoder</span>:
    <span style="color:#7ee787">format</span>: <span style="color:#a5d6ff">"anthropic_sse"</span>
  <span style="color:#7ee787">event_map</span>:
    - <span style="color:#7ee787">match</span>: <span style="color:#a5d6ff">"$.type == 'content_block_delta'"</span>
      <span style="color:#7ee787">emit</span>: <span style="color:#a5d6ff">"PartialContentDelta"</span>
<span style="color:#7ee787">error_classification</span>:
  <span style="color:#7ee787">by_http_status</span>:
    <span style="color:#a5d6ff">"429"</span>: <span style="color:#a5d6ff">"rate_limited"</span>
    <span style="color:#a5d6ff">"401"</span>: <span style="color:#a5d6ff">"authentication"</span>
<span style="color:#7ee787">capabilities</span>:
  <span style="color:#7ee787">streaming</span>: true
  <span style="color:#7ee787">tools</span>: true
  <span style="color:#7ee787">vision</span>: true</code></pre>
            </div>
          </div>
        </div>
      </section>

      <!-- Ecosystem Architecture -->
      <section class="section-alt">
        <div class="container">
          <div class="text-center mb-10">
            <h2 class="text-3xl font-bold text-[var(--text)] mb-4">仕様の位置づけ</h2>
            <p class="text-lg text-[var(--text-dim)] max-w-2xl mx-auto">
              AI-Protocol は基盤層です。ランタイムが消費し、アプリケーションがランタイムを消費します。
            </p>
          </div>
          <EcosystemOverview locale={locale} />
        </div>
      </section>

      <!-- Supported Providers -->
      <section class="section">
        <div class="container">
          <h2 class="text-3xl font-bold text-[var(--text)] mb-4 text-center">対応プロバイダー</h2>
          <p class="text-lg text-[var(--text-dim)] max-w-2xl mx-auto text-center mb-10">
            各プロバイダーには、エンドポイント、認証、パラメータマッピング、ストリーミングデコーダー、エラーハンドリング、機能フラグを備えた完全な YAML マニフェストがあります。
          </p>

          <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4">
            {['OpenAI', 'Anthropic', 'Google Gemini', 'Groq', 'Mistral', 'DeepSeek', 'Qwen', 'Cohere', 'Azure OpenAI', 'Together AI', 'Perplexity', 'NVIDIA', 'Fireworks AI', 'Replicate', 'OpenRouter', 'DeepInfra', 'AI21 Labs', 'Cerebras', 'Lepton AI', 'Zhipu GLM', 'Doubao', 'Baidu ERNIE', 'Tencent Hunyuan', 'iFlytek Spark', 'Moonshot', 'MiniMax', 'Baichuan', 'Yi / 01.AI', 'SiliconFlow', 'SenseNova'].map(name => (
              <div class="flex items-center gap-2 px-3 py-2.5 rounded-lg border border-[var(--border)] bg-[var(--bg-card)] text-sm text-[var(--text)]">
                <div class="w-2 h-2 rounded-full bg-purple-400 flex-shrink-0"></div>
                {name}
              </div>
            ))}
          </div>
        </div>
      </section>

      <!-- CTA -->
      <section class="section-alt">
        <div class="container text-center">
          <h2 class="text-3xl font-bold text-[var(--text)] mb-4">仕様を探る</h2>
          <p class="text-lg text-[var(--text-dim)] mb-8 max-w-xl mx-auto">
            仕様を読む、プロバイダーマニフェストを閲覧する、または新しいプロバイダーを貢献する。
          </p>
          <div class="flex flex-wrap gap-4 justify-center">
            <a href="/ja/protocol/overview/" class="inline-flex items-center gap-2 px-6 py-3 bg-purple-600 text-white font-semibold rounded-lg hover:bg-purple-700 transition-all hover:no-underline">ドキュメント</a>
            <a href="/ja/protocol/contributing/" class="inline-flex items-center gap-2 px-6 py-3 border border-[var(--border)] text-[var(--text)] font-semibold rounded-lg hover:bg-[var(--bg-alt)] transition-all hover:no-underline">プロバイダーを貢献</a>
          </div>
        </div>
      </section>
    </main>

    <Footer locale={locale} />
  </body>
</html>
