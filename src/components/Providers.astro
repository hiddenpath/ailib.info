---
const { locale = 'en' } = Astro.props;
const isZh = locale === 'zh';

// Providers organized by category
const providersByCategory = {
  global: [
    { name: 'OpenAI', domain: 'openai.com' },
    { name: 'Anthropic', domain: 'anthropic.com' },
    { name: 'Groq', domain: 'groq.com' },
    { name: 'Gemini', domain: 'gemini.google.com' },
    { name: 'Mistral', domain: 'mistral.ai' },
    { name: 'Cohere', domain: 'cohere.com' },
    { name: 'OpenRouter', domain: 'openrouter.ai' },
    { name: 'Replicate', domain: 'replicate.com' },
    { name: 'TogetherAI', domain: 'together.ai' },
    { name: 'Perplexity', domain: 'perplexity.ai' },
    { name: 'AI21', domain: 'ai21.com' },
    { name: 'HuggingFace', domain: 'huggingface.co' },
    { name: 'DeepSeek', domain: 'deepseek.com' },
    { name: 'xAI Grok', domain: 'x.ai' },
    { name: 'Azure OpenAI', domain: 'azure.microsoft.com' },
  ],
  china: [
    { name: 'ZhipuAI', domain: 'zhipuai.cn' },
    { name: 'MiniMax', domain: 'minimax.chat' },
    { name: 'Qwen', domain: 'qwen.ai' },
    { name: 'Moonshot Kimi', domain: 'moonshot.cn' },
    { name: 'Baidu Wenxin', domain: 'baidu.com' },
    { name: 'Tencent Hunyuan', domain: 'hunyuan.tencent.com' },
    { name: 'iFlytek Spark', domain: 'xfyun.cn' },
    { name: 'Baichuan', domain: 'baichuan-ai.com' },
    { name: 'SenseNova', domain: 'sensechat.com' },
  ],
  local: [
    { name: 'Ollama', domain: 'ollama.com' },
    { name: 'vLLM', domain: 'vllm.ai' },
    { name: 'LlamaCpp', domain: 'llama-cpp-python.readthedocs.io' },
    { name: 'LocalAI', domain: 'localai.io' },
  ]
};

const totalProviders = Object.values(providersByCategory).reduce((sum, arr) => sum + arr.length, 0);
---

<section class="py-24 bg-slate-50 dark:bg-slate-900/50">
  <div class="container mx-auto px-6">
    <div class="text-center max-w-3xl mx-auto mb-16">
      <h2 class="text-4xl font-bold text-slate-900 dark:text-white mb-4">
        {isZh ? `æ”¯æŒçš„æä¾›å•†` : 'Supported Providers'}
      </h2>
      <p class="text-xl text-slate-600 dark:text-slate-400">
        {isZh
          ? `30+ AI æä¾›å•†ï¼Œå…¨çƒè¦†ç›–ï¼Œç»Ÿä¸€æ¥å£`
          : `${totalProviders} AI providers, global coverage, unified interface`}
      </p>
    </div>

    <div class="space-y-16">
      {Object.entries(providersByCategory).map(([category, providers]) => {
        const categoryInfo = {
          global: {
            name: isZh ? 'å…¨çƒæä¾›å•† ğŸŒ' : 'Global Providers ğŸŒ',
            desc: isZh ? 'å›½é™…ä¸»æµ AI æœåŠ¡å•†' : 'Leading international AI providers'
          },
          china: {
            name: isZh ? 'ä¸­å›½åŒºæä¾›å•† ğŸ‡¨ğŸ‡³' : 'China Region ğŸ‡¨ğŸ‡³',
            desc: isZh ? 'å›½å†…é¢†å…ˆçš„ AI æœåŠ¡å•†' : 'Leading China-region AI providers'
          },
          local: {
            name: isZh ? 'æœ¬åœ°å’Œè‡ªæ‰˜ç®¡ ğŸ ' : 'Local & Self-hosted ğŸ ',
            desc: isZh ? 'æœ¬åœ°è¿è¡Œå’Œè‡ªå®šä¹‰æ¨¡å‹' : 'Self-hosted and custom models'
          }
        };

        const info = categoryInfo[category as keyof typeof categoryInfo];

        return (
          <div>
            <div class="flex flex-col md:flex-row md:items-end justify-between mb-8 pb-4 border-b border-slate-200 dark:border-slate-800">
              <div>
                <h3 class="text-2xl font-bold text-slate-900 dark:text-white">{info.name}</h3>
                <p class="text-slate-500 dark:text-slate-400 mt-1">{info.desc}</p>
              </div>
            </div>

            <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4">
              {providers.map((p) => {
                const favicon = `https://www.google.com/s2/favicons?sz=64&domain=${p.domain}`;
                return (
                  <div class="group flex items-center p-3 rounded-xl bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 transition-all hover:border-blue-500/50 hover:shadow-lg hover:shadow-blue-500/5 hover:-translate-y-0.5">
                    <div class="w-8 h-8 rounded-lg bg-slate-50 dark:bg-slate-800 p-1 mr-3 group-hover:bg-blue-50 dark:group-hover:bg-blue-900/30 transition-colors">
                      <img
                        src={favicon}
                        alt={`${p.name} favicon`}
                        loading="lazy"
                        class="w-full h-full object-contain"
                        onerror="this.style.display='none';this.nextElementSibling.style.display='flex';"
                      />
                      <span class="hidden w-full h-full items-center justify-center text-xs font-bold text-slate-400">
                        {p.name.charAt(0)}
                      </span>
                    </div>
                    <span class="text-sm font-semibold text-slate-700 dark:text-slate-300 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">
                      {p.name}
                    </span>
                  </div>
                );
              })}
            </div>
          </div>
        );
      })}
    </div>

    <div class="mt-20 pt-12 text-center border-t border-slate-200 dark:border-slate-800">
      <a href="/protocol/providers/" class="inline-flex items-center px-6 py-3 rounded-full bg-blue-600 text-white font-bold transition-all hover:bg-blue-700 hover:shadow-xl hover:shadow-blue-500/20 active:scale-95">
        {isZh ? 'æŸ¥çœ‹å®Œæ•´çš„ Provider åˆ—è¡¨' : 'View full provider list'}
        <svg class="ml-2 w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
        </svg>
      </a>
    </div>
  </div>
</section>
