---
interface Props {
  locale?: string;
  variant: 'protocol' | 'rust' | 'python' | 'mock';
  version: string;
  title: string;
  description: string;
  features: string[];
  link: string;
  github: string;
}

const { locale = 'en', variant, version, title, description, features, link, github } = Astro.props;

const colorMap = {
  protocol: {
    border: 'border-purple-500/20 hover:border-purple-500/40',
    bg: 'bg-purple-500/5',
    badge: 'bg-purple-500/10 text-purple-400 border-purple-500/20',
    icon: 'text-purple-400',
    gradient: 'from-purple-500 to-pink-500',
  },
  rust: {
    border: 'border-orange-500/20 hover:border-orange-500/40',
    bg: 'bg-orange-500/5',
    badge: 'bg-orange-500/10 text-orange-400 border-orange-500/20',
    icon: 'text-orange-400',
    gradient: 'from-orange-500 to-red-500',
  },
  python: {
    border: 'border-emerald-500/20 hover:border-emerald-500/40',
    bg: 'bg-emerald-500/5',
    badge: 'bg-emerald-500/10 text-emerald-400 border-emerald-500/20',
    icon: 'text-emerald-400',
    gradient: 'from-emerald-500 to-cyan-500',
  },
  mock: {
    border: 'border-slate-500/20 hover:border-slate-500/40',
    bg: 'bg-slate-500/5',
    badge: 'bg-slate-500/10 text-slate-400 border-slate-500/20',
    icon: 'text-slate-400',
    gradient: 'from-slate-500 to-zinc-500',
  },
};

const colors = colorMap[variant];

const learnMoreLabels: Record<string, string> = {
  en: 'Learn more',
  'zh-cn': '了解更多',
  zh: '了解更多',
  ja: 'もっと見る',
  es: 'Más información',
};
const learnMore = learnMoreLabels[locale] ?? learnMoreLabels.en;

const iconMap = {
  protocol: `<svg class="w-8 h-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" /></svg>`,
  rust: `<svg class="w-8 h-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.59 14.37a6 6 0 01-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 006.16-12.12A14.98 14.98 0 009.631 8.41m5.96 5.96a14.926 14.926 0 01-5.841 2.58m-.119-8.54a6 6 0 00-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 00-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 01-2.448-2.448 14.9 14.9 0 01.06-.312m-2.24 2.39a4.493 4.493 0 00-1.757 4.306 4.493 4.493 0 004.306-1.758M16.5 9a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z" /></svg>`,
  python: `<svg class="w-8 h-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M17.25 6.75L22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3l-4.5 16.5" /></svg>`,
  mock: `<svg class="w-8 h-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z" /></svg>`,
};
---

<a href={link} class={`group block p-6 rounded-2xl border ${colors.border} ${colors.bg} transition-all duration-300 hover:shadow-lg hover:no-underline`}>
  <div class="flex items-start justify-between mb-4">
    <div class={`${colors.icon}`} set:html={iconMap[variant]} />
    <span class={`inline-flex items-center px-2.5 py-0.5 text-xs font-mono font-medium rounded-full border ${colors.badge}`}>
      v{version}
    </span>
  </div>

  <h3 class="text-xl font-bold text-[var(--text)] mb-2 group-hover:opacity-90">
    {title}
  </h3>

  <p class="text-sm text-[var(--text-dim)] mb-4 leading-relaxed">
    {description}
  </p>

  <ul class="space-y-1.5">
    {features.map(f => (
      <li class="flex items-center gap-2 text-sm text-[var(--text-muted)]">
        <svg class={`w-4 h-4 flex-shrink-0 ${colors.icon}`} fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
        </svg>
        {f}
      </li>
    ))}
  </ul>

  <div class="mt-5 pt-4 border-t border-[var(--border)] flex items-center justify-between">
    <span class="text-sm font-medium text-[var(--accent)] group-hover:translate-x-1 transition-transform inline-flex items-center gap-1">
      {learnMore}
      <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
      </svg>
    </span>
    <a href={github} target="_blank" rel="noopener" class="text-[var(--text-muted)] hover:text-[var(--text)] transition-colors" onclick="event.stopPropagation()">
      <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
    </a>
  </div>
</a>
